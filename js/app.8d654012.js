(function(e){function t(t){for(var i,o,s=t[0],u=t[1],d=t[2],l=t[3]||[],p=0,v=[];p<s.length;p++)o=s[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&v.push(r[o][0]),r[o]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);f&&f(t),c.push.apply(c,l);while(v.length)v.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var u=n[s];0!==r[u]&&(i=!1)}i&&(a.splice(t--,1),e=d(d.s=n[0]))}return 0===a.length&&(c.forEach((function(e){if(void 0===r[e]){r[e]=null;var t=document.createElement("link");d.nc&&t.setAttribute("nonce",d.nc),t.rel="prefetch",t.as="script",t.href=o(e),document.head.appendChild(t)}})),c.length=0),e}var i={},r={app:0},a=[],c=[];function o(e){return d.p+"js/"+({}[e]||e)+"."+{"chunk-39894da9":"95c083ed"}[e]+".js"}var s={};var u={"9c7e":function(){return{"./buttplug_rs_ffi_bg.js":{__wbindgen_object_drop_ref:function(e){return i["761c"].exports["nb"](e)},__wbindgen_object_clone_ref:function(e){return i["761c"].exports["mb"](e)},__wbindgen_cb_drop:function(e){return i["761c"].exports["db"](e)},__wbindgen_string_new:function(e,t){return i["761c"].exports["pb"](e,t)},__wbg_instanceof_Window_49f532f06a9786ee:function(e){return i["761c"].exports["r"](e)},__wbg_navigator_95ba9cd684cf90aa:function(e){return i["761c"].exports["z"](e)},__wbg_getCharacteristic_b001b7c09638ce1e:function(e,t,n){return i["761c"].exports["k"](e,t,n)},__wbg_value_3776803576d97fcc:function(e){return i["761c"].exports["ab"](e)},__wbg_setoncharacteristicvaluechanged_f7ee268791e4983f:function(e,t){return i["761c"].exports["R"](e,t)},__wbg_startNotifications_a4df90bb7133a56e:function(e){return i["761c"].exports["V"](e)},__wbg_writeValue_da005325ac8ca005:function(e,t,n){return i["761c"].exports["cb"](e,t,n)},__wbg_target_4bc4eb28204bcc44:function(e){return i["761c"].exports["X"](e)},__wbg_requestDevice_84f02605191b7abe:function(e,t){return i["761c"].exports["J"](e,t)},__wbg_id_1d8f28399ea3eab4:function(e,t){return i["761c"].exports["q"](e,t)},__wbg_name_fb1fa7e6ecd19fc5:function(e,t){return i["761c"].exports["y"](e,t)},__wbg_gatt_75077e6ef5ab3193:function(e){return i["761c"].exports["j"](e)},__wbg_bluetooth_22ee2659ffe37867:function(e){return i["761c"].exports["a"](e)},__wbg_setonopen_c24d49cee44daad8:function(e,t){return i["761c"].exports["U"](e,t)},__wbg_setonerror_64ee2a67b3f7eebf:function(e,t){return i["761c"].exports["S"](e,t)},__wbg_setonmessage_fcc92da9f859cdc2:function(e,t){return i["761c"].exports["T"](e,t)},__wbg_new_df8fc59a35e30ae9:function(e,t){return i["761c"].exports["D"](e,t)},__wbg_close_95e96a88da73491e:function(e){return i["761c"].exports["f"](e)},__wbg_send_c6982a9ac7d4b83d:function(e,t,n){return i["761c"].exports["O"](e,t,n)},__wbg_connect_1fca84c2f4ff511c:function(e){return i["761c"].exports["g"](e)},__wbg_getPrimaryService_b884fcd1544ed03c:function(e,t,n){return i["761c"].exports["l"](e,t,n)},__wbg_data_5c896013c39c6e21:function(e){return i["761c"].exports["i"](e)},__wbg_log_75fc43480a5907a7:function(e,t){return i["761c"].exports["t"](e,t)},__wbg_log_a73f6bdd88fae982:function(e,t,n,r,a,c,o,s){return i["761c"].exports["u"](e,t,n,r,a,c,o,s)},__wbg_mark_e32edf3b52687c6a:function(e,t){return i["761c"].exports["v"](e,t)},__wbg_measure_0c2a5c5e55e16643:function(e,t,n,r){return i["761c"].exports["w"](e,t,n,r)},__wbg_call_951bd0c6d815d6f1:function(e,t){return i["761c"].exports["d"](e,t)},__wbg_new_9dff83a08f5994f3:function(){return i["761c"].exports["A"]()},__wbg_push_3ddd8187ff2ff82d:function(e,t){return i["761c"].exports["H"](e,t)},__wbg_buffer_20c611418be17f9d:function(e){return i["761c"].exports["b"](e)},__wbg_newnoargs_7c6bd521992b4022:function(e,t){return i["761c"].exports["E"](e,t)},__wbg_call_bf745b1758bb6693:function(e,t,n){return i["761c"].exports["e"](e,t,n)},__wbg_new_ba07d0daa0e4677e:function(){return i["761c"].exports["B"]()},__wbg_resolve_6e61e640925a0db9:function(e){return i["761c"].exports["L"](e)},__wbg_then_dd3785597974798a:function(e,t){return i["761c"].exports["Z"](e,t)},__wbg_then_0f957e0f4c3e537a:function(e,t,n){return i["761c"].exports["Y"](e,t,n)},__wbg_self_6baf3a3aa7b63415:function(){return i["761c"].exports["N"]()},__wbg_window_63fc4027b66c265b:function(){return i["761c"].exports["bb"]()},__wbg_globalThis_513fb247e8e4e6d2:function(){return i["761c"].exports["o"]()},__wbg_global_b87245cd886d7113:function(){return i["761c"].exports["p"]()},__wbindgen_is_undefined:function(e){return i["761c"].exports["kb"](e)},__wbg_buffer_3f12a1c608c6d04e:function(e){return i["761c"].exports["c"](e)},__wbg_newwithbyteoffsetandlength_4c51342f87299c5a:function(e,t,n){return i["761c"].exports["G"](e,t,n)},__wbg_length_c645e7c02233b440:function(e){return i["761c"].exports["s"](e)},__wbg_new_c6c0228e6d22a2f9:function(e){return i["761c"].exports["C"](e)},__wbg_set_b91afac9fd216d99:function(e,t,n){return i["761c"].exports["Q"](e,t,n)},__wbg_newwithbyteoffset_2f2d8bb07cac609c:function(e,t){return i["761c"].exports["F"](e,t)},__wbg_set_9bdd413385146137:function(e,t,n){return i["761c"].exports["P"](e,t,n)},__wbg_getRandomValues_3ac1b33c90b52596:function(e,t,n){return i["761c"].exports["n"](e,t,n)},__wbg_randomFillSync_6f956029658662ec:function(e,t,n){return i["761c"].exports["I"](e,t,n)},__wbg_self_1c83eb4471d9eb9b:function(){return i["761c"].exports["M"]()},__wbg_static_accessor_MODULE_abf5ae284bffdf45:function(){return i["761c"].exports["W"]()},__wbg_require_5b2b5b594d809d9f:function(e,t,n){return i["761c"].exports["K"](e,t,n)},__wbg_crypto_c12f14e810edcaa2:function(e){return i["761c"].exports["h"](e)},__wbg_msCrypto_679be765111ba775:function(e){return i["761c"].exports["x"](e)},__wbg_getRandomValues_05a60bf171bfc2be:function(e){return i["761c"].exports["m"](e)},__wbindgen_is_string:function(e){return i["761c"].exports["jb"](e)},__wbindgen_string_get:function(e,t){return i["761c"].exports["ob"](e,t)},__wbindgen_debug_string:function(e,t){return i["761c"].exports["ib"](e,t)},__wbindgen_throw:function(e,t){return i["761c"].exports["qb"](e,t)},__wbindgen_memory:function(){return i["761c"].exports["lb"]()},__wbindgen_closure_wrapper522:function(e,t,n){return i["761c"].exports["fb"](e,t,n)},__wbindgen_closure_wrapper524:function(e,t,n){return i["761c"].exports["gb"](e,t,n)},__wbindgen_closure_wrapper526:function(e,t,n){return i["761c"].exports["hb"](e,t,n)},__wbindgen_closure_wrapper2502:function(e,t,n){return i["761c"].exports["eb"](e,t,n)}}}}};function d(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,d),n.l=!0,n.exports}d.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=i);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,d.nc&&c.setAttribute("nonce",d.nc),c.src=o(e);var l=new Error;a=function(t){c.onerror=c.onload=null,clearTimeout(p);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",l.name="ChunkLoadError",l.type=i,l.request=a,n[1](l)}r[e]=void 0}};var p=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}var v={"chunk-39894da9":["9c7e"]}[e]||[];return v.forEach((function(e){var n=s[e];if(n)t.push(n);else{var i,r=u[e](),a=fetch(d.p+""+{"9c7e":"7d0eaa77716029a17e95"}[e]+".module.wasm");if(r instanceof Promise&&"function"===typeof WebAssembly.compileStreaming)i=Promise.all([WebAssembly.compileStreaming(a),r]).then((function(e){return WebAssembly.instantiate(e[0],e[1])}));else if("function"===typeof WebAssembly.instantiateStreaming)i=WebAssembly.instantiateStreaming(a,r);else{var c=a.then((function(e){return e.arrayBuffer()}));i=c.then((function(e){return WebAssembly.instantiate(e,r)}))}t.push(s[e]=i.then((function(t){return d.w[e]=(t.instance||t).exports})))}})),Promise.all(t)},d.m=e,d.c=i,d.d=function(e,t,n){d.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},d.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(e,t){if(1&t&&(e=d(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(d.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)d.d(n,i,function(t){return e[t]}.bind(null,i));return n},d.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return d.d(t,"a",t),t},d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},d.p="",d.oe=function(e){throw console.error(e),e},d.w={};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],p=l.push.bind(l);l.push=t,l=l.slice();for(var v=0;v<l.length;v++)t(l[v]);var f=p,h=function(){return a.push([0,"chunk-vendors"]),n()}();t([[],{},0,["chunk-39894da9"]])})({0:function(e,t,n){e.exports=n("cd49")},"087e":function(e,t,n){"use strict";n("461a")},"0c1a":function(e,t,n){},"0ea6":function(e,t,n){},"0f59":function(e,t,n){},1059:function(e,t,n){},"3c30":function(e,t,n){},"461a":function(e,t,n){},"4c18":function(e,t,n){},"5c0b":function(e,t,n){"use strict";n("9c0c")},"5f9c":function(e,t,n){"use strict";n("0ea6")},6886:function(e,t,n){"use strict";n("eb4d")},"73fa":function(e,t,n){"use strict";n("1059")},"92cf":function(e,t,n){},"944d":function(e,t,n){},"9c0c":function(e,t,n){},b221:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"fullscreen"},[n("Workspace")],1),e.popupOpen?n("div",{staticClass:"popup-background fullscreen"},[n(e.popup,e._b({tag:"component"},"component",e.popupProps,!1))],1):e._e()])},a=[],c=n("d4ec"),o=n("bee2"),s=n("262e"),u=n("2caf"),d=n("9ab4"),l=n("60a3"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-columns"},[n("WorkspaceMenu",{attrs:{project:e.project},on:{projectchanged:e.setProject}}),n("div",{staticClass:"flex-rows"},[n("div",{attrs:{id:"workspace-sidebar"}},[n("ComponentBrowser",{attrs:{nodes:e.project.nodes}})],1),n("ProjectProvider",{attrs:{project:e.project}},[e.showEditor?n("NodeEditor",{attrs:{project:e.project}}):e._e()],1)],1),n("WorkspaceFooter",{attrs:{project:e.project}})],1)},v=[],f=(n("96cf"),n("1da1")),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ComponentBrowser"},[n("ComponentCategoryBrowser",{attrs:{nodes:e.nodes,category:e.category},on:{categorychanged:e.setCategory}}),n("ComponentBrowserList",{attrs:{nodes:e.nodes,category:e.category}})],1)},b=[],m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ComponentCategoryBrowser"},[n("ul",e._l(e.nodes.categories,(function(t){return n("li",{key:t.id},[n("button",{class:{active:t.id==e.category},attrs:{title:t.name},on:{click:function(n){return e.setCategory(t.id)}}},[n("i",{class:t.icon})])])})),0)])},g=[],y=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(o["a"])(n,[{key:"setCategory",value:function(e){this.$emit("categorychanged",e)}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],y.prototype,"category",void 0),Object(d["a"])([Object(l["c"])()],y.prototype,"nodes",void 0),y=Object(d["a"])([Object(l["a"])({components:{}})],y);var O=y,_=O,j=(n("e934"),n("2877")),w=Object(j["a"])(_,m,g,!1,null,null,null),k=w.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ComponentBrowserList"},[n("ul",e._l(e.items,(function(t){return n("li",{key:t.componentId},[n("drag",{attrs:{"transfer-data":t.componentId}},[n("div",{staticClass:"ComponentBrowserListRecord"},[n("strong",[e._v(e._s(t.componentName))]),n("br"),n("small",[e._v(e._s(t.description))])])])],1)})),0)])},I=[],C=n("df76"),E=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(o["a"])(n,[{key:"created",value:function(){this.redraw=this.redraw.bind(this),this.onNodesChanged(this.nodes)}},{key:"onNodesChanged",value:function(e,t){t&&(t.removeEventListener("notetypeadded",this.redraw),t.removeEventListener("notetyperemoved",this.redraw)),e.addEventListener("nodetypeadded",this.redraw),e.addEventListener("nodetyperemoved",this.redraw)}},{key:"beforeDestroy",value:function(){this.nodes.removeEventListener("nodetypeadded",this.redraw),this.nodes.removeEventListener("nodetyperemoved",this.redraw)}},{key:"redraw",value:function(){this.$forceUpdate()}},{key:"items",get:function(){return this.nodes.filtered(this.category)}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],E.prototype,"category",void 0),Object(d["a"])([Object(l["c"])()],E.prototype,"nodes",void 0),Object(d["a"])([Object(l["f"])("nodes")],E.prototype,"onNodesChanged",null),E=Object(d["a"])([Object(l["a"])({components:{Drag:C["Drag"]}})],E);var T=E,P=T,S=(n("cfd5"),Object(j["a"])(P,x,I,!1,null,null,null)),D=S.exports,N=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.category="all",e}return Object(o["a"])(n,[{key:"setCategory",value:function(e){this.category=e}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],N.prototype,"nodes",void 0),N=Object(d["a"])([Object(l["a"])({components:{ComponentCategoryBrowser:k,ComponentBrowserList:D}})],N);var R=N,V=R,M=(n("cd9d"),Object(j["a"])(V,h,b,!1,null,null,null)),L=M.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("drop",{staticStyle:{width:"100%",height:"100%"},on:{drop:e.createNewComponent}},[n("baklava-editor",{attrs:{plugin:e.viewPlugin}})],1)},$=[],q=(n("d3b7"),n("ddb0"),n("b85c")),B=function(){function e(){Object(c["a"])(this,e),this.time=0,this.startTime=this.getSystemTime()}return Object(o["a"])(e,[{key:"reset",value:function(){this.startTime=this.getSystemTime()}},{key:"tick",value:function(){this.time=this.getSystemTime()-this.startTime}},{key:"getTime",value:function(){return this.time}},{key:"getSystemTime",value:function(){return(new Date).getTime()/1e3}}]),e}(),z=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.runtime=new B,e}return Object(o["a"])(n,[{key:"mounted",value:function(){this.start()}},{key:"beforeDestroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)}},{key:"start",value:function(){this.runtime.reset(),this.nextTick()}},{key:"nextTick",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t,n,i,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.timer=void 0,this.runtime.tick(),t={time:this.runtime.getTime()},e.next=5,this.engine.calculate(t);case 5:if(n=e.sent,n){e.next=8;break}return e.abrupt("return");case 8:i=Object(q["a"])(n.keys());try{for(i.s();!(r=i.n()).done;)a=r.value,a.send(t)}catch(c){i.e(c)}finally{i.f()}this.timer=setTimeout(this.nextTick.bind(this),100);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"createNewComponent",value:function(e,t){var n=this.project.nodes.create(e);if(n){this.editor.addNode(n);var i=n;i.position.x=t.offsetX/this.viewPlugin.scaling-this.viewPlugin.panning.x,i.position.y=t.offsetY/this.viewPlugin.scaling-this.viewPlugin.panning.y}}},{key:"board",get:function(){return this.project.currentWorkspace.currentBoard}},{key:"viewPlugin",get:function(){return this.board.viewPlugin}},{key:"engine",get:function(){return this.board.engine}},{key:"editor",get:function(){return this.board.editor}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],z.prototype,"project",void 0),z=Object(d["a"])([Object(l["a"])({components:{Drop:C["Drop"]}})],z);var W,U=z,G=U,F=Object(j["a"])(G,A,$,!1,null,null,null),J=F.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"workspace-menu"},[n("ul",[n("li",[n("button",{on:{click:e.newProject}},[e._v("New")])]),n("li",[n("button",{staticClass:"file-button"},[e._v("Load "),n("input",{attrs:{type:"file",accept:"text/json, .json"},on:{change:e.loadProject}})])]),n("li",[n("button",{on:{click:e.saveProject}},[e._v("Save")])])])])},Y=[],X=(n("d81d"),n("13d5"),n("b0c0"),n("07ac"),n("130f"),n("a4d3"),n("e01a"),n("4de4"),n("7db0"),n("c740"),n("a434"),n("9072")),K=n("dac5"),Q=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.name=e.constructor.componentName,e.type=e.constructor.componentId,e}return Object(o["a"])(n,[{key:"send",value:function(e){}//! Returns a hash if this component might be serialized
},{key:"hash",value:function(){var e=this.serializeType();return null===e?e:JSON.stringify(e)}},{key:"serializeType",value:function(){return{origin:"core",name:this.type,inputPorts:[],outputPorts:[]}}}]),n}(K["Node"]);Q.componentId="",Q.componentName="Component",Q.category="all",Q.description="",function(e){e[e["Add"]=1]="Add",e[e["Sub"]=2]="Sub",e[e["Mul"]=3]="Mul",e[e["Div"]=4]="Div",e[e["Mod"]=5]="Mod"}(W||(W={}));var Z=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addOption("Operator","SelectOption",W.Add,void 0,{items:[{value:W.Add,text:"Add"},{value:W.Sub,text:"Subtract"},{value:W.Mul,text:"Multiply"},{value:W.Div,text:"Divide"},{value:W.Mod,text:"Modulo"}]}),e.addInputInterface("Operand A","NumberOption",0,{type:"number"}),e.addInputInterface("Operand B","NumberOption",0,{type:"number"}),e.addOutputInterface("Result",{type:"number"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(){var e=this.getInterface("Operand A").value,t=this.getInterface("Operand B").value,n=this.getInterface("Result");switch(this.getOptionValue("Operator")){case W.Add:n.value=e+t;break;case W.Sub:n.value=e-t;break;case W.Mul:n.value=e*t;break;case W.Div:n.value=0===t?1/0:e/t;break;case W.Mod:n.value=0===t?1/0:e%t;break}}}]),n}(Q);Z.componentId="Calculation",Z.componentName="Calculation",Z.category="math",Z.description="Performs simple calculation";var ee=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addInputInterface("Value","NumberOption",0,{type:"number"}),e.addInputInterface("Minimum","NumberOption",0,{type:"number"}),e.addInputInterface("Maximum","NumberOption",1,{type:"number"}),e.addOutputInterface("Result",{type:"number"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(){var e=this.getInterface("Value").value,t=this.getInterface("Minimum").value,n=this.getInterface("Maximum").value;this.getInterface("Result").value=Math.min(n,Math.max(t,e))}}]),n}(Q);ee.componentId="Clamp",ee.componentName="Clamp",ee.category="math",ee.description="Ensures that a value is in a range";var te=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(e){var i;Object(c["a"])(this,n),i=t.call(this),i.device=e;var r,a=Object(q["a"])(i.device.inputPorts());try{for(a.s();!(r=a.n()).done;){var o=r.value;switch(o.type){case"number":i.addInputInterface(o.name,"NumberOption",0,{type:"number"})}}}catch(s){a.e(s)}finally{a.f()}return i}return Object(o["a"])(n,[{key:"send",value:function(){var e,t=Object(q["a"])(this.device.inputPorts());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.device.setInputValue(n,this.getInterface(n.name).value)}}catch(i){t.e(i)}finally{t.f()}}},{key:"serializeType",value:function(){return{origin:"device",name:this.type,inputPorts:this.device.inputPorts().map((function(e){return{id:e.id,name:e.name,type:e.type}})),outputPorts:[]}}}]),n}(Q);te.category="device";var ne=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addOutputInterface("Time",{type:"time"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(e){this.getInterface("Time").value=e.time}}]),n}(Q);ne.componentId="Time",ne.componentName="Time",ne.category="signal",ne.description="Session duration starting at zero";var ie,re=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addInputInterface("Value","NumberOption",0,{type:"number"}),e.addOption("Result","VisualizeOption",{value:0,time:0}),e}return Object(o["a"])(n,[{key:"send",value:function(e){this.setOptionValue("Result",{value:this.getInterface("Value").value,time:e.time})}}]),n}(Q);re.componentId="VisualizeWave",re.componentName="Wave Visualizer",re.category="signal",re.description="Visualizes the input wave",function(e){e[e["Sine"]=1]="Sine",e[e["Square"]=2]="Square",e[e["Sawtooth"]=3]="Sawtooth",e[e["Triangle"]=4]="Triangle"}(ie||(ie={}));var ae=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addOption("Wave Type","SelectOption",ie.Sine,void 0,{items:[{value:ie.Sine,text:"Sine"},{value:ie.Square,text:"Square"},{value:ie.Sawtooth,text:"Sawtooth"},{value:ie.Triangle,text:"Triangle"}]}),e.addOption("Only Positive Wave","CheckboxOption",!1),e.addInputInterface("Time","TimeOption",0,{type:"time"}),e.addInputInterface("Amplitude","NumberOption",1,{type:"number"}),e.addInputInterface("Frequency","NumberOption",1,{type:"number"}),e.addOutputInterface("Output",{type:"number"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(e){var t=this.getInterface("Time"),n=t.connectionCount>0?t.value:e.time,i=this.getInterface("Amplitude").value,r=this.getInterface("Frequency").value,a=this.getOptionValue("Only Positive Wave"),c=a?i:0,o=this.getInterface("Output");switch(this.getOptionValue("Wave Type")){case ie.Sine:o.value=Math.sin(2*n*Math.PI*r)*i+c;break;case ie.Square:o.value=(n*r%1>=.5?-i:i)+c;break;case ie.Sawtooth:o.value=(n*r+.75)%1*i*2+c-i;break;case ie.Triangle:var s=(n*r*2+.75)%2*i*2-i;o.value=s>i?2*i-s+c:s+c;break}}}]),n}(Q);ae.componentId="WaveGenerator",ae.componentName="Wave Generator",ae.category="signal",ae.description="Generates a wave signal";var ce=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addInputInterface("Number","NumberOption",0,{type:"number"}),e.addOutputInterface("Value",{type:"number"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(){this.getInterface("Value").value=this.getInterface("Number").value}}]),n}(Q);ce.componentId="Constant",ce.componentName="Constant",ce.category="signal",ce.description="Provides a constant value";var oe=n("45eb"),se=n("7e84"),ue=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addOption("Signal","DeviceFeatureOption",void 0,void 0,{allowedTags:["sensor"]}),e.addOutputInterface("Value",{type:"number"}),e}return Object(o["a"])(n,[{key:"load",value:function(e){e.options=[],Object(oe["a"])(Object(se["a"])(n.prototype),"load",this).call(this,e)}},{key:"save",value:function(){var e=Object(oe["a"])(Object(se["a"])(n.prototype),"save",this).call(this),t=this.getOptionValue("Signal");return e.options=[["Signal",t?t.getHash():null]],e}},{key:"calculate",value:function(){var e=this.getOptionValue("Signal");this.getInterface("Value").value=e?e.getSensorValue():0}}]),n}(Q);ue.componentId="RemoteSignal",ue.componentName="Remote Signal",ue.category="signal",ue.description="Provides a signal from an external device";var de=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.lastTime=0,e.lastTick=0,e.duration=0,e.probesPerSecond=10,e.tickDuration=1,e.records=[],e.sum=0,e.maxSize=0,e.count=0,e.index=0,e.addOption("Duration","NumberOption",10),e.addInputInterface("Value","NumberOption",0,{type:"number"}),e.addOutputInterface("Average",{type:"number"}),e}return Object(o["a"])(n,[{key:"getDuration",value:function(){return Math.max(.1,this.getOptionValue("Duration"))}},{key:"reset",value:function(){var e=this.getDuration();this.lastTime=0,this.lastTick=0,this.index=0,this.count=0,this.sum=0,this.tickDuration=1/this.probesPerSecond,this.maxSize=e*this.probesPerSecond}},{key:"calculate",value:function(e){var t=this.getDuration();(e.time<this.lastTime||t!==this.duration)&&(this.reset(),this.duration=t),this.lastTick+=e.time-this.lastTime,this.lastTime=e.time;var n=this.getInterface("Value").value;while(this.lastTick>=this.tickDuration)this.addTick(n),this.lastTick-=this.tickDuration;0===this.count?this.getInterface("Average").value=n:this.getInterface("Average").value=this.sum/this.count}},{key:"addTick",value:function(e){this.index<this.count&&(this.sum-=this.records[this.index]),this.records[this.index++]=e,this.sum+=e,this.count=Math.max(this.count,this.index),this.index=this.index%this.maxSize}}]),n}(Q);de.componentId="Average",de.componentName="Average",de.category="math",de.description="Provides the average of an input value";var le=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.lastValue=0,e.lastTrigger=!1,e.addOption("On positive Edge only","CheckboxOption",!1),e.addInputInterface("Input","NumberOption",0,{type:"number"}),e.addInputInterface("Trigger","CheckboxOption",!1,{type:"boolean"}),e.addOutputInterface("Output",{type:"number"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(){var e=this.getOptionValue("On positive Edge only"),t=this.getInterface("Trigger").value;t!==this.lastTrigger&&(e&&!t||(this.lastValue=this.getInterface("Input").value),this.lastTrigger=t),this.getInterface("Output").value=this.lastValue}}]),n}(Q);le.componentId="Memory",le.componentName="Memory",le.category="math",le.description="Remembers the value of the last trigger";var pe=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addInputInterface("Minimum","NumberOption",-1,{type:"number"}),e.addInputInterface("Maximum","NumberOption",1,{type:"number"}),e.addOutputInterface("Output",{type:"number"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(){var e=this.getInterface("Minimum").value,t=this.getInterface("Maximum").value;this.getInterface("Output").value=Math.random()*(t-e)+e}}]),n}(Q);pe.componentId="Random",pe.componentName="Random Generator",pe.category="signal",pe.description="Generates a random signal";var ve,fe=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(e){var i;Object(c["a"])(this,n),i=t.call(this),i.device=e;var r,a=Object(q["a"])(i.device.outputPorts());try{for(a.s();!(r=a.n()).done;){var o=r.value;switch(o.type){case"number":i.addOutputInterface(o.name,{type:"number"});break}}}catch(s){a.e(s)}finally{a.f()}return i}return Object(o["a"])(n,[{key:"calculate",value:function(){var e,t=Object(q["a"])(this.device.getSensorValues());try{for(t.s();!(e=t.n()).done;){var n=e.value,i=n.name,r=n.value;this.getInterface(i).value=r}}catch(a){t.e(a)}finally{t.f()}}},{key:"serializeType",value:function(){return{origin:"device",name:this.type,outputPorts:this.device.outputPorts().map((function(e){return{id:e.id,name:e.name,type:e.type}})),inputPorts:[]}}}]),n}(Q);fe.category="device",function(e){e[e["Equal"]=1]="Equal",e[e["NotEqual"]=2]="NotEqual",e[e["LessThan"]=3]="LessThan",e[e["LessThanOrEqual"]=4]="LessThanOrEqual",e[e["GreaterThan"]=5]="GreaterThan",e[e["GreaterThanOrEqual"]=6]="GreaterThanOrEqual"}(ve||(ve={}));var he=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addOption("Test","SelectOption",ve.GreaterThan,void 0,{items:[{value:ve.Equal,text:"Equal (=)"},{value:ve.NotEqual,text:"Not equal (!=)"},{value:ve.LessThan,text:"Less than (<)"},{value:ve.LessThanOrEqual,text:"Less than or equal (<=)"},{value:ve.GreaterThan,text:"Greater than (>)"},{value:ve.GreaterThanOrEqual,text:"Greater than or equal (>=)"}]}),e.addInputInterface("Operand A","NumberOption",0,{type:"number"}),e.addInputInterface("Operand B","NumberOption",0,{type:"number"}),e.addOutputInterface("True",{type:"boolean"}),e.addOutputInterface("False",{type:"boolean"}),e}return Object(o["a"])(n,[{key:"calculate",value:function(){var e=this.getInterface("Operand A").value,t=this.getInterface("Operand B").value,n=this.getInterface("True");switch(this.getOptionValue("Test")){case ve.Equal:n.value=e==t;break;case ve.NotEqual:n.value=e!=t;break;case ve.LessThan:n.value=e<t;break;case ve.LessThanOrEqual:n.value=e<=t;break;case ve.GreaterThan:n.value=e>t;break;case ve.GreaterThanOrEqual:n.value=e>=t;break}this.getInterface("False").value=!n.value}}]),n}(Q);he.componentId="Conditional",he.componentName="Conditional",he.category="math",he.description="Performs condition tests";var be=10,me=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;Object(c["a"])(this,n),e=t.call(this),e.width=200,e.twoColumn=!0,e.activeState=1,e.lastInputValues=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];for(var i=1;i<=be;i++)e.addInputInterface("Trigger ".concat(i),"CheckboxOption",!1,{type:"boolean"}),e.addOutputInterface("State ".concat(i),{type:"boolean"});return e.getInterface("State 1").value=!0,e}return Object(o["a"])(n,[{key:"calculate",value:function(){for(var e=this.activeState,t=1;t<=be;t++){var n=this.getInterface("Trigger ".concat(t)).value;n&&!this.lastInputValues[t-1]&&(e=t),this.lastInputValues[t-1]=n}e!==this.activeState&&(this.getInterface("State ".concat(this.activeState)).value=!1,this.activeState=e,this.getInterface("State ".concat(this.activeState)).value=!0)}}]),n}(Q);me.componentId="StateMachine",me.componentName="State Machine",me.category="math",me.description="Allows to control several states";var ge=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.call(this),e.addOption("Vibrator","DeviceFeatureOption",void 0,void 0,{allowedTags:["vibrate"]}),e.addInputInterface("Value","NumberOption",0,{type:"number"}),e}return Object(o["a"])(n,[{key:"load",value:function(e){e.options=[],Object(oe["a"])(Object(se["a"])(n.prototype),"load",this).call(this,e)}},{key:"save",value:function(){var e=Object(oe["a"])(Object(se["a"])(n.prototype),"save",this).call(this),t=this.getOptionValue("Vibrator");return e.options=[["Vibrator",t?t.getHash():null]],e}},{key:"send",value:function(){var e=this.getOptionValue("Vibrator");e&&e.setInputValue(this.getInterface("Value").value)}}]),n}(Q);ge.componentId="Vibrator",ge.componentName="Vibrator",ge.category="device",ge.description="Connected to a remote vibrator";var ye=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.nodes=[],e.categories=[],e.deviceNodes={},e}return Object(o["a"])(n,[{key:"filtered",value:function(e){return"all"===e?this.nodes:this.nodes.filter((function(t){return t.category===e}))}},{key:"addCategory",value:function(e,t,n){this.categories.push({id:e,name:t,icon:n})}},{key:"add",value:function(e){var t=this.nodes.findIndex((function(t){return t.componentId===e.componentId}));t>=0&&this.nodes.splice(t,1),this.dispatchEvent(new CustomEvent("nodetypeadded",{detail:e})),this.nodes.push(e),this.nodes.sort((function(e,t){return e.componentName<t.componentName?-1:1}))}},{key:"remove",value:function(e){var t=this.nodes.findIndex((function(t){return t.componentId===e.componentId}));t>=0&&this.nodes.splice(t,1),this.dispatchEvent(new CustomEvent("nodetyperemoved",{detail:e}))}},{key:"addDeviceNode",value:function(e,t){this.deviceNodes[e.id]||(this.deviceNodes[e.id]=[]),this.deviceNodes[e.id].push(t),this.add(t)}},{key:"addCustomDevice",value:function(e){var t=function(t){Object(s["a"])(i,t);var n=Object(u["a"])(i);function i(){return Object(c["a"])(this,i),n.call(this,e)}return i}(te);t.componentId=e.id,t.componentName=e.name,t.description=e.description,this.addDeviceNode(e,t),e.outputPorts().length&&this.addCustomDeviceInput(e)}},{key:"addCustomDeviceInput",value:function(e){var t=function(t){Object(s["a"])(i,t);var n=Object(u["a"])(i);function i(){return Object(c["a"])(this,i),n.call(this,e)}return i}(fe);t.componentId=e.id+"Input",t.componentName=e.name+" (Signals)",t.description=e.description+" (Signals)",this.addDeviceNode(e,t)}},{key:"removeCustomDevice",value:function(e){if(this.deviceNodes[e.id]){var t,n=Object(q["a"])(this.deviceNodes[e.id]);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.remove(i)}}catch(r){n.e(r)}finally{n.f()}this.deviceNodes[e.id]=[]}}},{key:"create",value:function(e){var t=this.nodes.find((function(t){return t.componentId===e}));return t?new t:null}},{key:"registerDefaultNodes",value:function(){this.addCategory("all","All","fas fa-folder"),this.addCategory("device","Devices","fas fa-charging-station"),this.addCategory("signal","Signals","fas fa-wave-square"),this.addCategory("math","Math","fas fa-square-root-alt"),this.add(ne),this.add(ae),this.add(re),this.add(Z),this.add(he),this.add(me),this.add(ee),this.add(ue),this.add(ce),this.add(de),this.add(le),this.add(ge),this.add(pe)}},{key:"all",get:function(){return this.nodes}}]),n}(Object(X["a"])(EventTarget)),Oe="maidkun/buttplug-editor/project",_e=1,je=(n("3ca3"),function(){function e(t){Object(c["a"])(this,e),this.project=new Fe(t)}return Object(o["a"])(e,[{key:"load",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.project.initialize();case 2:return e.next=4,Promise.all(t.workspace.boards.map((function(e){return n.restoreBoard(e)})));case 4:return e.abrupt("return",this.project);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"restoreBoard",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.project.currentWorkspace.currentBoard.editor.load(t.state);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}()),we=n("0c30"),ke=n("9f16"),xe=n("261c"),Ie=n("0048"),Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"visualize-wave"},[n("canvas",{ref:"canvas"})])},Ee=[],Te=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.pixelPerY=30,e.lastTime=0,e.lastValue=0,e.context=null,e}return Object(o["a"])(n,[{key:"valueChanged",value:function(e){if(this.context&&this.canvas){var t=this.canvas.width,n=this.canvas.height,i=n/2,r=e.time-this.lastTime,a=this.context,c=Math.floor(r*this.pixelPerSecond);c&&(a.drawImage(a.canvas,-c,0),a.fillRect(t-c,0,c,n)),a.beginPath(),a.moveTo(t-r*this.pixelPerSecond,this.lastValue*-this.pixelPerY+i),a.lineTo(t,e.value*-this.pixelPerY+i),a.stroke(),this.lastTime=e.time,this.lastValue=e.value}}},{key:"mounted",value:function(){var e=this.$refs.container;this.canvas=this.$refs.canvas;var t=e.clientWidth,n=e.clientHeight;this.canvas.width=t,this.canvas.height=n,this.context=this.canvas.getContext("2d"),this.context&&(this.context.strokeStyle="#0f0",this.context.lineWidth=1,this.context.fillStyle="#222",this.context.fillRect(0,0,t,n))}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],Te.prototype,"value",void 0),Object(d["a"])([Object(l["c"])({default:10})],Te.prototype,"pixelPerSecond",void 0),Object(d["a"])([Object(l["f"])("value")],Te.prototype,"valueChanged",null),Te=Object(d["a"])([l["a"]],Te);var Pe=Te,Se=Pe,De=(n("73fa"),Object(j["a"])(Se,Ce,Ee,!1,null,null,null)),Ne=De.exports,Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:function(){e.open=!1},expression:"() => { open = false; }"}],class:["dark-select",{"--open":e.open}],on:{click:function(t){e.open=!e.open}}},[n("div",{staticClass:"__selected"},[n("div",{staticClass:"__text"},[e._v(e._s(e.value?e.value.getText():""))]),n("div",{staticClass:"__icon"})]),n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"__dropdown"},[n("div",{staticClass:"item --header"},[e._v(e._s(e.name))]),e._l(e.ports,(function(t,i){return n("div",{key:i,class:["item",{"--active":e.isSelected(t)}],on:{click:function(n){return e.setSelected(t)}}},[e._v(e._s(t.getText()))])}))],2)]),e.hasAnyDevice?e._e():n("span",[e._v("No device with vibrator-support has been connected")])],1)},Ve=[],Me=(n("99af"),n("c975"),n("45fc"),function(){function e(t,n){Object(c["a"])(this,e),this._device=t,this._port=n}return Object(o["a"])(e,[{key:"getHash",value:function(){return"".concat(this._device.id,"//").concat(this._port.id)}},{key:"getText",value:function(){return"".concat(this._device.name,": ").concat(this._port.name)}},{key:"setInputValue",value:function(e){this._device.setInputValue(this._port,e)}},{key:"getSensorValue",value:function(){var e=this,t=this._device.getSensorValues().find((function(t){return t.name===e._port.name}));return t?t.value:0}}]),e}()),Le=n("c28b"),Ae=n.n(Le),$e=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.ports=[],e.hasAnyDevice=!1,e.open=!1,e}return Object(o["a"])(n,[{key:"created",value:function(){this.onUpdate=this.onUpdate.bind(this)}},{key:"mounted",value:function(){this.project.connections.addEventListener("deviceadded",this.onUpdate),this.project.connections.addEventListener("deviceremoved",this.onUpdate),this.onUpdate()}},{key:"isSelected",value:function(e){return this.value===e}},{key:"setSelected",value:function(e){this.$emit("input",e)}},{key:"onUpdate",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.project.connections.connections.map((function(e){return e.getDevices()})).reduce((function(e,t){return e.concat(t)}),[]),n=t.map((function(e){return i.filterDevicePorts(e)})).reduce((function(e,t){return e.concat(t)}),[]),this.ports=n,this.hasAnyDevice=Boolean(n.length),e.next=6,this.$nextTick();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"beforeDestroy",value:function(){this.project.connections.removeEventListener("deviceadded",this.onUpdate),this.project.connections.removeEventListener("deviceremoved",this.onUpdate)}},{key:"filterDevicePorts",value:function(e){return this.filterPorts(e,e.inputPorts()).concat(this.filterPorts(e,e.outputPorts()))}},{key:"filterPorts",value:function(e,t){var n=this;return t.filter((function(e){return 0===n.allowedTags.length||e.tags.some((function(e){return n.allowedTags.indexOf(e)>=0}))})).map((function(t){return new Me(e,t)}))}},{key:"allowedTags",get:function(){return this.option.allowedTags||[]}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])({type:String})],$e.prototype,"name",void 0),Object(d["a"])([Object(l["c"])({type:Object})],$e.prototype,"option",void 0),Object(d["a"])([Object(l["c"])()],$e.prototype,"value",void 0),Object(d["a"])([Object(l["b"])()],$e.prototype,"project",void 0),$e=Object(d["a"])([Object(l["a"])({components:{SelectOption:ke["SelectOption"]},directives:{ClickOutside:Ae.a.directive}})],$e);var qe=$e,Be=qe,ze=Object(j["a"])(Be,Re,Ve,!1,null,null,null),We=ze.exports,Ue=function(){function e(){Object(c["a"])(this,e),this.editor=new K["Editor"],this.viewPlugin=new we["ViewPlugin"],this.optionPlugin=new ke["OptionPlugin"],this.intfTypePlugin=new xe["InterfaceTypePlugin"],this.engine=new Ie["Engine"](!1),this.editor.use(this.optionPlugin),this.editor.use(this.viewPlugin),this.editor.use(this.intfTypePlugin),this.editor.use(this.engine),this.viewPlugin.registerOption("VisualizeOption",Ne),this.viewPlugin.registerOption("DeviceFeatureOption",We),this.intfTypePlugin.addType("time","#88ff00"),this.intfTypePlugin.addType("number","#888888"),this.intfTypePlugin.addType("boolean","#0088ff"),this.intfTypePlugin.addConversion("time","number",(function(e){return e})),this.intfTypePlugin.addConversion("number","time",(function(e){return e})),this.intfTypePlugin.addConversion("boolean","number",(function(e){return e?1:0})),this.intfTypePlugin.addConversion("number","boolean",(function(e){return e>.01}))}return Object(o["a"])(e,[{key:"serialize",value:function(){return{state:this.editor.save()}}},{key:"allNodes",value:function(){return this.editor.nodes}}]),e}(),Ge=function(){function e(){Object(c["a"])(this,e),this.currentBoard=new Ue}return Object(o["a"])(e,[{key:"serialize",value:function(){return{boards:[this.currentBoard.serialize()]}}},{key:"allNodes",value:function(){return this.currentBoard.allNodes()}},{key:"registerNodeType",value:function(e){this.currentBoard.editor.registerNodeType(e.componentId,e)}}]),e}(),Fe=function(){function e(t){var n=this;Object(c["a"])(this,e),this.nodes=new ye,this.workspace=new Ge,this.onDeviceAdded=function(e){n.nodes.addCustomDevice(e.detail)},this.onDevicesRemoved=function(e){n.nodes.removeCustomDevice(e.detail)},this.onNodeTypeAdded=function(e){n.workspace.registerNodeType(e.detail)},this.connections=t,this.connections.addEventListener("deviceadded",this.onDeviceAdded),this.connections.addEventListener("deviceremoved",this.onDevicesRemoved),this.nodes.addEventListener("nodetypeadded",this.onNodeTypeAdded)}return Object(o["a"])(e,[{key:"unload",value:function(){this.connections.removeEventListener("deviceadded",this.onDeviceAdded),this.connections.removeEventListener("deviceremoved",this.onDevicesRemoved),this.nodes.removeEventListener("nodetypeadded",this.onNodeTypeAdded)}},{key:"initialize",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.nodes.registerDefaultNodes(),this.connections.triggerDeviceEventsAgain();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=document.createElement("a"),t=JSON.stringify(this.serialize());e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),e.setAttribute("download","buttplugeditor-project.json"),e.style.display="none",document.body.appendChild(e),e.click(),setImmediate((function(){document.body.removeChild(e)}))}},{key:"serialize",value:function(){return{identifier:Oe,version:_e,workspace:this.workspace.serialize(),components:this.serializeNodeTypes()}}},{key:"serializeNodeTypes",value:function(){var e=this.workspace.allNodes().map((function(e){return e.serializeType()})),t=e.reduce((function(e,t){return e[t.name]=t,e}),{});return Object.values(t)}},{key:"currentWorkspace",get:function(){return this.workspace}}],[{key:"load",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.identifier===Oe){e.next=2;break}throw new Error("Project identifier is invalid");case 2:if(t.version===_e){e.next=4;break}throw new Error("Project version is invalid");case 4:return i=new je(n),e.abrupt("return",i.load(t));case 6:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()}]),e}(),Je=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(o["a"])(n,[{key:"newProject",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(confirm("This will clear the entire workspace.")){e.next=2;break}return e.abrupt("return");case 2:return t=new Fe(this.project.connections),e.next=5,t.initialize();case 5:this.$emit("projectchanged",t);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadProject",value:function(e){var t=this;if(e.target){var n=e.target.files;if(n&&n.length){var i=new FileReader;i.onload=function(e){if(e.target){var n=JSON.parse(e.target.result);n?Fe.load(n,t.project.connections).then((function(e){t.$emit("projectchanged",e)})).catch((function(e){alert(e)})):alert("The uploaded file could not be parsed as JSON.")}},i.readAsText(n[0])}}}},{key:"saveProject",value:function(){this.project.save()}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],Je.prototype,"project",void 0),Je=Object(d["a"])([Object(l["a"])({components:{}})],Je);var He=Je,Ye=He,Xe=(n("d7b4"),Object(j["a"])(Ye,H,Y,!1,null,null,null)),Ke=Xe.exports,Qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("footer",{attrs:{id:"workspace-footer"}},[n("div",{staticClass:"flex-stretch"}),n("ConnectionIndicator",{attrs:{manager:e.project.connections}})],1)},Ze=[],et=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{on:{click:e.show}},["disconnected"===e.status?n("span",[n("i",{staticClass:"text-danger fas fa-circle"}),e._v(" No Connections ")]):e._e(),"connecting"===e.status&&0===e.numConnections?n("span",[n("i",{staticClass:"text-warning fas fa-spin fa-circle-notch"}),e._v(" Connecting ")]):e._e(),"connecting"===e.status&&e.numConnections>0?n("span",[n("i",{staticClass:"text-warning fas fa-spin fa-circle-notch"}),e._v(" "+e._s(e.numConnections)+" Connection(s) ")]):e._e(),"connected"===e.status?n("span",[n("i",{staticClass:"text-success fas fa-circle"}),e._v(" "+e._s(e.numConnections)+" Connection(s) ")]):e._e()])])},tt=[],nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Popup",{attrs:{header:"Connections"}},[n("div",{staticClass:"scroll-container"},[n("ul",{staticClass:"connection-list"},e._l(e.configurations,(function(t){return n("li",{key:t.configuration.protocol+"|"+t.configuration.address+"|"+t.configuration.port},[n("ConnectionListItem",{attrs:{item:t},on:{retry:e.retry,disconnect:e.disconnect}})],1)})),0)])])},it=[],rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"popup"},[n("div",{staticClass:"popup-header"},[n("h2",[e._v(e._s(e.header))]),n("Button",{on:{click:e.close}},[n("i",{staticClass:"fas fa-times"})])],1),n("div",{staticClass:"popup-body"},[e._t("default")],2),n("div",{staticClass:"popup-footer"})])},at=[],ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{staticClass:"btn",on:{click:e.click}},[e._t("default")],2)},ot=[],st=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(o["a"])(n,[{key:"click",value:function(){this.$emit("click")}}]),n}(l["e"]);st=Object(d["a"])([l["a"]],st);var ut=st,dt=ut,lt=(n("087e"),Object(j["a"])(dt,ct,ot,!1,null,null,null)),pt=lt.exports,vt=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(o["a"])(n,[{key:"close",value:function(){this.$root.$emit("popupclose")}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])({default:""})],vt.prototype,"header",void 0),vt=Object(d["a"])([Object(l["a"])({components:{Button:pt}})],vt);var ft=vt,ht=ft,bt=(n("ddda"),Object(j["a"])(ht,rt,at,!1,null,null,null)),mt=bt.exports,gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"connection-list-item"},[n("span",{staticClass:"connection-list-item-status"},["disconnected"===e.item.status?n("span",[n("i",{staticClass:"text-danger fas fa-circle"})]):e._e(),"connecting"===e.item.status?n("span",[n("i",{staticClass:"text-warning fas fa-spin fa-circle-notch"})]):e._e(),"connected"===e.item.status?n("span",[n("i",{staticClass:"text-success fas fa-circle"})]):e._e()]),n("span",{staticClass:"connection-list-item-name"},[n("small",[e._v(e._s(e.item.configuration.protocol))]),n("strong",[e._v("ws://"+e._s(e.item.configuration.address)+":"+e._s(e.item.configuration.port)+"/")])]),"disconnected"===e.item.status?n("Button",{on:{click:e.retry}},[n("i",{staticClass:"fas fa-sync"})]):e._e(),"connected"===e.item.status?n("Button",{on:{click:e.disconnect}},[n("i",{staticClass:"fas fa-stop"})]):e._e()],1)},yt=[],Ot=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return Object(o["a"])(n,[{key:"retry",value:function(){this.$emit("retry",this.item)}},{key:"disconnect",value:function(){this.$emit("disconnect",this.item)}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],Ot.prototype,"item",void 0),Ot=Object(d["a"])([Object(l["a"])({components:{Button:pt}})],Ot);var _t=Ot,jt=_t,wt=(n("fef9"),Object(j["a"])(jt,gt,yt,!1,null,null,null)),kt=wt.exports,xt=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.isMounted=!1,e.configurations=[],e}return Object(o["a"])(n,[{key:"onManagerChanged",value:function(e,t){t&&t.removeEventListener("changed",this.onChange.bind(this)),e&&this.isMounted&&e.addEventListener("changed",this.onChange.bind(this)),this.onChange()}},{key:"onChange",value:function(){this.configurations=this.manager.configurations}},{key:"mounted",value:function(){this.isMounted=!0,this.manager.addEventListener("changed",this.onChange.bind(this)),this.onChange()}},{key:"beforeDestroy",value:function(){this.isMounted=!1,this.manager.removeEventListener("changed",this.onChange.bind(this))}},{key:"retry",value:function(e){this.manager.connect(e)}},{key:"disconnect",value:function(e){this.manager.disconnect(e)}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],xt.prototype,"manager",void 0),Object(d["a"])([Object(l["f"])("manager")],xt.prototype,"onManagerChanged",null),xt=Object(d["a"])([Object(l["a"])({components:{Popup:mt,ConnectionListItem:kt}})],xt);var It=xt,Ct=It,Et=(n("fba5"),Object(j["a"])(Ct,nt,it,!1,null,null,null)),Tt=Et.exports,Pt=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.status="disconnected",e.numConnections=0,e.isMounted=!1,e}return Object(o["a"])(n,[{key:"onManagerChanged",value:function(e,t){t&&t.removeEventListener("changed",this.onChange.bind(this)),e&&this.isMounted&&e.addEventListener("changed",this.onChange.bind(this)),this.onChange()}},{key:"onChange",value:function(){this.status=this.manager.state,this.numConnections=this.manager.connections.length}},{key:"mounted",value:function(){this.isMounted=!0,this.manager.addEventListener("changed",this.onChange.bind(this)),this.onChange()}},{key:"beforeDestroy",value:function(){this.isMounted=!1,this.manager.removeEventListener("changed",this.onChange.bind(this))}},{key:"show",value:function(){this.$root.$emit("popup",Tt,{manager:this.manager})}}]),n}(l["e"]);Object(d["a"])([Object(l["c"])()],Pt.prototype,"manager",void 0),Object(d["a"])([Object(l["f"])("manager")],Pt.prototype,"onManagerChanged",null),Pt=Object(d["a"])([l["a"]],Pt);var St=Pt,Dt=St,Nt=Object(j["a"])(Dt,et,tt,!1,null,null,null),Rt=Nt.exports,Vt=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return n}(l["e"]);Object(d["a"])([Object(l["c"])()],Vt.prototype,"project",void 0),Vt=Object(d["a"])([Object(l["a"])({components:{ConnectionIndicator:Rt}})],Vt);var Mt=Vt,Lt=Mt,At=(n("6886"),Object(j["a"])(Lt,Qe,Ze,!1,null,null,null)),$t=At.exports,qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-rows"},[e._t("default")],2)},Bt=[],zt=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return n}(l["e"]);Object(d["a"])([Object(l["d"])(),Object(l["c"])()],zt.prototype,"project",void 0),zt=Object(d["a"])([l["a"]],zt);var Wt=zt,Ut=Wt,Gt=Object(j["a"])(Ut,qt,Bt,!1,null,null,null),Ft=Gt.exports,Jt=function(){function e(t){Object(c["a"])(this,e),this.isExecuting=!1,this.hasResult=!1,this.resolve=[],this.reject=[],this.callback=t}return Object(o["a"])(e,[{key:"invoke",value:function(){return this.isExecuting?this.listenToCurrentCall():this.reload()}},{key:"reload",value:function(){var e=this;return this.hasResult=!1,this.isExecuting=!0,new Promise((function(t,n){e.resolve.push(t),e.reject.push(n),e.callback().then((function(t){e.setResult(t)})).catch((function(t){e.setError(t)}))}))}},{key:"setResult",value:function(e){this.hasResult=!0,this.isExecuting=!1,this.error=void 0;var t=this.resolve;this.resolve=[],this.reject=[];var n,i=Object(q["a"])(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r(e)}}catch(a){i.e(a)}finally{i.f()}}},{key:"setError",value:function(e){this.hasResult=!0,this.isExecuting=!1;var t=this.reject;this.resolve=[],this.reject=[];var n,i=Object(q["a"])(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r(e)}}catch(a){i.e(a)}finally{i.f()}}},{key:"listenToCurrentCall",value:function(){var e=this;return new Promise((function(t,n){if(!e.hasResult)return e.resolve.push(t),void e.reject.push(n);e.error?n(e.error):t(e.result)}))}}]),e}(),Ht=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(c["a"])(this,n),t.apply(this,arguments)}return n}(Object(X["a"])(EventTarget)),Yt=n("aaf3"),Xt=n("e1b9"),Kt=n("fe93"),Qt=n("b969"),Zt=function(){function e(t,n){Object(c["a"])(this,e),this.description="",this.id=t,this.name=n}return Object(o["a"])(e,[{key:"triggerUpdate",value:function(){var e=this;this._immediate||(this._immediate=setImmediate((function(){e._immediate=void 0,e.sendUpdates()})))}},{key:"sendUpdates",value:function(){}},{key:"setInputValue",value:function(e,t){}},{key:"getSensorValues",value:function(){return[]}}]),e}(),en=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(e,i){var r;return Object(c["a"])(this,n),r=t.call(this,e,i.Name),r.vibrators=[],r._updatedPorts=[],r.device=i,r.description="Buttplug device ".concat(i.Index),r._inputPorts=[],r.addVibrate(),r}return Object(o["a"])(n,[{key:"addVibrate",value:function(){var e=this.device.messageAttributes(Qt["b"].VibrateCmd);if(e)for(var t=0;t<(e.featureCount||1);t++)this._inputPorts.push({type:"number",tags:["vibrate"],id:"vibrate".concat(t),name:"Motor ".concat(t+1),buttplugType:"vibrate",buttplugIndex:t})}},{key:"inputPorts",value:function(){return this._inputPorts}},{key:"outputPorts",value:function(){return[]}},{key:"setInputValue",value:function(e,t){this.vibrators[e.buttplugIndex]!==t&&(this.vibrators[e.buttplugIndex]=t,this._updatedPorts.push(e),this.triggerUpdate())}},{key:"sendUpdates",value:function(){var e=this,t=this._updatedPorts;this._updatedPorts=[];var n=t.filter((function(e){return"vibrate"===e.buttplugType})).map((function(t){return new Qt["c"](t.buttplugIndex,Math.min(1,Math.max(0,e.vibrators[t.buttplugIndex])))}));n.length&&this.device.vibrate(n)}}]),n}(Zt),tn=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"127.0.0.1",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12345;return Object(c["a"])(this,n),e=t.call(this),e.devices={},e.disconnected=function(){for(var t=0,n=Object.values(e.devices);t<n.length;t++){var i=n[t];e.removeDevice(i.device)}e.devices={}},e.addDevice=function(t){e.devices[t.Index]||(e.devices[t.Index]=new en("Device".concat(t.Index,"@").concat(e.connector.Address),t),e.dispatchEvent(new CustomEvent("deviceadded",{detail:e.devices[t.Index]})))},e.removeDevice=function(t){e.devices[t.Index]&&(e.dispatchEvent(new CustomEvent("deviceremoved",{detail:e.devices[t.Index]})),delete e.devices[t.Index])},e.connector=new Yt["b"],e.connector.Address="ws://".concat(i,":").concat(r,"/"),e.client=new Xt["a"]("Buttplug Interactive Editor"),e.client.addListener("deviceadded",e.addDevice),e.client.addListener("deviceremoved",e.removeDevice),e.client.addListener("disconnect",e.disconnected),e}return Object(o["a"])(n,[{key:"getDevices",value:function(){return Object.values(this.devices)}},{key:"triggerDeviceEventsAgain",value:function(){for(var e=0,t=Object.values(this.devices);e<t.length;e++){var n=t[e];this.dispatchEvent(new CustomEvent("deviceadded",{detail:n}))}}},{key:"connect",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.client.connect(this.connector);case 2:return e.next=4,this.client.startScanning();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"disconnect",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.client.disconnect());case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(Ht);tn.initialize=new Jt(Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Kt["b"]();case 2:console.log("Buttplug initialized.");case 3:case"end":return e.stop()}}),e)}))));n("b64b");var nn=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(e,i,r){var a;return Object(c["a"])(this,n),a=t.call(this,e,r.DeviceName),a.vibrators=[],a._updatedPorts=[],a.sensors=[],a.device=r,a.description="DevIo device ".concat(r.DeviceIndex),a._inputPorts=[],a._outputPorts=[],a.socket=i,a.addVibrate(),a.addSensors(),a}return Object(o["a"])(n,[{key:"addVibrate",value:function(){var e=this.device.DeviceMessages.VibrateCmd;if(e)for(var t=0;t<(e.FeatureCount||1);t++)this._inputPorts.push({type:"number",tags:["vibrate"],id:e.Identifier?e.Identifier[t]:"vibrate".concat(t),name:e.Description?e.Description[t]:"Motor ".concat(t+1),buttplugType:"vibrate",buttplugIndex:t})}},{key:"addSensors",value:function(){var e=this.device.DeviceMessages.SensorReadCmd;if(e)for(var t=0;t<(e.FeatureCount||1);t++)this._outputPorts.push({type:"number",tags:["sensor"],id:e.Identifier?e.Identifier[t]:"sensor".concat(t),name:e.Description?e.Description[t]:"Sensor ".concat(t+1),buttplugType:"sensor",buttplugIndex:t}),this.socket.send({SensorSubscribeCmd:{Id:this.socket.nextId++,DeviceIndex:this.device.DeviceIndex,Sensor:t}}),this.sensors.push(0)}},{key:"getSensorValues",value:function(){var e=this;return Object.keys(this.sensors).map((function(t){return{name:e._outputPorts[parseInt(t)].name,value:e.sensors[parseInt(t)]}}))}},{key:"setSensorValue",value:function(e,t){this.sensors[e]=t}},{key:"setInputValue",value:function(e,t){this.vibrators[e.buttplugIndex]!==t&&(this.vibrators[e.buttplugIndex]=t,this._updatedPorts.push(e),this.triggerUpdate())}},{key:"sendUpdates",value:function(){var e=this,t=this._updatedPorts;this._updatedPorts=[];var n=t.filter((function(e){return"vibrate"===e.buttplugType})).map((function(t){return{Index:t.buttplugIndex,Speed:e.vibrators[t.buttplugIndex]}}));n.length&&this.socket.send({VibrateCmd:{Id:this.socket.nextId++,DeviceIndex:this.device.DeviceIndex,Speeds:n}})}},{key:"sendVibrates",value:function(e){console.log("SEND VIBRATE",e)}},{key:"inputPorts",value:function(){return this._inputPorts}},{key:"outputPorts",value:function(){return this._outputPorts}}]),n}(Zt),rn=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"127.0.0.1",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12345;return Object(c["a"])(this,n),e=t.call(this),e.nextId=1,e.devices={},e.messageResponseMap={},e.disconnected=function(){for(var t=0,n=Object.values(e.devices);t<n.length;t++){var i=n[t];e.removeDevice(i.device)}e.devices={}},e.removeDevice=function(t){e.devices[t.DeviceIndex]&&(e.dispatchEvent(new CustomEvent("deviceremoved",{detail:e.devices[t.DeviceIndex]})),delete e.devices[t.DeviceIndex])},e.url="ws://".concat(i,":").concat(r,"/"),e}return Object(o["a"])(n,[{key:"getDevices",value:function(){return Object.values(this.devices)}},{key:"send",value:function(e){if(!this.socket)throw new Error("Can not send message when socket is not connected");this.socket.send(JSON.stringify([e]))}},{key:"sendAndWait",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object.keys(t)[0],n){e.next=3;break}throw new Error("message must contain one message");case 3:return i=t[n].Id,e.abrupt("return",new Promise((function(e,n){r.messageResponseMap[i]={resolve:e,reject:n},r.send(t)})));case 5:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"loadDeviceList",value:function(e){console.log("Receives device list with ".concat(e.Devices.length," devices"));var t,n=Object(q["a"])(e.Devices);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.addDevice(i)}}catch(r){n.e(r)}finally{n.f()}}},{key:"updateSensor",value:function(e){var t=this.devices[e.DeviceIndex];t.setSensorValue(e.Sensor,e.Value)}},{key:"addDevice",value:function(e){this.devices[e.DeviceIndex]||(this.devices[e.DeviceIndex]=new nn("Device".concat(e.DeviceIndex,"@").concat(this.url),this,e),this.dispatchEvent(new CustomEvent("deviceadded",{detail:this.devices[e.DeviceIndex]})))}},{key:"triggerDeviceEventsAgain",value:function(){for(var e=0,t=Object.values(this.devices);e<t.length;e++){var n=t[e];this.dispatchEvent(new CustomEvent("deviceadded",{detail:n}))}}},{key:"onMessage",value:function(e){var t=Object.keys(e)[0];if(t){var n=e[t].Id;if(this.messageResponseMap[n])this.messageResponseMap[n].resolve(e[t]);else switch(t){case"Ok":break;case"DeviceList":this.loadDeviceList(e[t]);break;case"SensorUpdate":this.updateSensor(e[t]);break;default:console.error("Unknown server message: ".concat(t))}}else console.error("Server sent empty message")}},{key:"connect",value:function(){var e=this;return new Promise((function(t){var n=!1;e.socket=new WebSocket(e.url),e.socket.onopen=Object(f["a"])(regeneratorRuntime.mark((function i(){var r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=!0,console.log("Connected to server. Wait for server info."),i.next=4,e.sendAndWait({RequestServerInfo:{Id:e.nextId++,ClientName:"Buttplug Editor"}});case 4:r=i.sent,console.log("Server name is: ".concat(r.ServerName)),e.send({RequestDeviceList:{Id:e.nextId++}}),t();case 8:case"end":return i.stop()}}),i)}))),e.socket.onmessage=function(t){var n,i=Object(q["a"])(JSON.parse(t.data));try{for(i.s();!(n=i.n()).done;){var r=n.value;e.onMessage(r)}}catch(a){i.e(a)}finally{i.f()}},e.socket.onclose=function(){e.disconnected()},e.socket.onerror=function(e){if(!n)throw e;console.error(e)}}))}},{key:"disconnect",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.socket){e.next=2;break}return e.abrupt("return");case 2:this.socket.close();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(Ht),an=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e._state="disconnected",e._connections=[],e._configurations=[],e}return Object(o["a"])(n,[{key:"addDefaultConfigurations",value:function(){console.log(new Error),this.addConfiguration({protocol:"buttplug",address:"127.0.0.1",port:12345}),this.addConfiguration({protocol:"buttplug",address:"127.0.0.1",port:12346}),this.addConfiguration({protocol:"dev",address:"127.0.0.1",port:12355})}},{key:"addConfiguration",value:function(e){this._configurations.push({status:"disconnected",configuration:e})}},{key:"findConnections",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.state="connecting",e.next=3,Promise.all(this._configurations.map((function(e){return t.connect(e)})));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"disconnect",value:function(e){if(e.connection&&e.connect){this._connections=this._connections.filter((function(t){return t!==e.connection}));var t=e.connection;e.status="disconnected",e.connect=void 0,e.connection=void 0,t.disconnect(),0===this._connections.length?this.state="disconnected":this.state="connected",this.dispatchEvent(new CustomEvent("changed"))}}},{key:"connect",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.connection){e.next=2;break}return e.abrupt("return",t.connection);case 2:return e.next=4,this.createConnection(t.configuration);case 4:return n=e.sent,t.connect||(t.connect=new Jt(Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.status="connecting",i.dispatchEvent(new CustomEvent("changed")),i.connectEvents(n),e.next=5,n.connect();case 5:t.connection=n,i._connections.push(n),t.status="connected",0===i._connections.length?i.state="disconnected":i.state="connected",i.dispatchEvent(new CustomEvent("changed"));case 10:case"end":return e.stop()}}),e)}))))),e.prev=6,e.next=9,t.connect.invoke();case 9:e.next=17;break;case 11:return e.prev=11,e.t0=e["catch"](6),t.status="disconnected",t.connect=void 0,this.dispatchEvent(new CustomEvent("changed")),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[6,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createConnection",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t.protocol,e.next="buttplug"===e.t0?3:"dev"===e.t0?6:7;break;case 3:return e.next=5,tn.initialize.invoke();case 5:return e.abrupt("return",new tn(t.address,t.port));case 6:return e.abrupt("return",new rn(t.address,t.port));case 7:throw new Error("Invalid protocol: ".concat(t.protocol));case 8:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"connectEvents",value:function(e){var t=this;e.addEventListener("deviceadded",(function(e){t.dispatchEvent(new CustomEvent("deviceadded",{detail:e.detail}))})),e.addEventListener("deviceremoved",(function(e){t.dispatchEvent(new CustomEvent("deviceremoved",{detail:e.detail}))}))}},{key:"triggerDeviceEventsAgain",value:function(){var e,t=Object(q["a"])(this._connections);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.triggerDeviceEventsAgain()}}catch(i){t.e(i)}finally{t.f()}}},{key:"connections",get:function(){return this._connections}},{key:"configurations",get:function(){return this._configurations}},{key:"state",get:function(){return this._state},set:function(e){this._state=e,this.dispatchEvent(new CustomEvent("changed"))}}]),n}(Object(X["a"])(EventTarget)),cn=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.project=new Fe(new an),e.showEditor=!0,e}return Object(o["a"])(n,[{key:"created",value:function(){this.project.initialize(),this.project.connections.addDefaultConfigurations(),this.project.connections.findConnections().catch((function(e){return console.error(e)}))}},{key:"setProject",value:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.project.unload(),this.project=t,this.showEditor=!1,e.next=5,this.$nextTick();case 5:this.showEditor=!0;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(l["e"]);cn=Object(d["a"])([Object(l["a"])({components:{NodeEditor:J,ComponentBrowser:L,WorkspaceMenu:Ke,WorkspaceFooter:$t,ProjectProvider:Ft}})],cn);var on=cn,sn=on,un=(n("5f9c"),Object(j["a"])(sn,p,v,!1,null,null,null)),dn=un.exports,ln=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.popupOpen=!1,e}return Object(o["a"])(n,[{key:"created",value:function(){this.$root.$on("popup",this.openPopup.bind(this)),this.$root.$on("popupclose",this.closePopup.bind(this))}},{key:"openPopup",value:function(e,t){this.popup=e,this.popupOpen=!0,this.popupProps=t}},{key:"closePopup",value:function(){this.popupOpen=!1}}]),n}(l["e"]);ln=Object(d["a"])([Object(l["a"])({components:{Workspace:dn}})],ln);var pn=ln,vn=pn,fn=(n("5c0b"),Object(j["a"])(vn,r,a,!1,null,null,null)),hn=fn.exports;n("87e6"),n("944d");i["default"].config.productionTip=!1,i["default"].use(we["BaklavaVuePlugin"]),new i["default"]({render:function(e){return e(hn)}}).$mount("#app")},cd9d:function(e,t,n){"use strict";n("d307")},cfd5:function(e,t,n){"use strict";n("0c1a")},d307:function(e,t,n){},d7b4:function(e,t,n){"use strict";n("92cf")},ddda:function(e,t,n){"use strict";n("b221")},e934:function(e,t,n){"use strict";n("0f59")},eb4d:function(e,t,n){},fba5:function(e,t,n){"use strict";n("3c30")},fef9:function(e,t,n){"use strict";n("4c18")}});
//# sourceMappingURL=app.8d654012.js.map